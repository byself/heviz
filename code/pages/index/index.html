<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>首頁</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

        <link rel="apple-touch-icon" href="icon.png">
        <!-- Place favicon.ico in the root directory -->

        <!-- //
            1. 样式文件加载有先后顺序：normalize.css -> common.css
            2. normalize.css是重置样式，必须首先被加载；
            3. main.css是公共样式;
         //-->
        <link rel="stylesheet" href="../../css/normalize.css">
        <link rel="stylesheet" href="../..//js/vendor/swiper/css/swiper.min.css">
        <link rel="stylesheet" href="../..//js/vendor/videojs/video.min.css">

        <link rel="stylesheet" href="../../css/common.css">
        <link rel="stylesheet" href="../../css/index.css">
    </head>
    <body>

    <div class="app">

        <header class="head">
            <div class="logo">
                <img src="../../images/logo.png" alt="HEVIZ">
            </div>

            <div class="head-left">
                <div class="bell-box">
                    <div class="bell-count"><span>6</span></div>
                </div>
            </div>

            <div class="head-right">
                <div class="cart-box">
                    <div class="cart-count"><span>6</span></div>
                </div>
            </div>
        </header>

        <main class="main" id="main">
            <div class="index-mod" id="mod1">
                <video id="video" class="video-js vjs-big-play-centered"></video>
            </div>

            <div class="index-mod" id="mod2">
                <a href=""><img src="../../images/img01.jpg" alt=""></a>
            </div>

            <div class="page-slide">
                <!-- Swiper -->
                <div class="swiper-container">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide" style="background-image: url('../../images/slide01.jpg')"><a class="link" href=""></a></div>
                        <div class="swiper-slide" style="background-image: url('../../images/slide02.jpg')"><a class="link" href=""></a></div>
                        <div class="swiper-slide" style="background-image: url('../../images/slide03.jpg')"><a class="link" href=""></a></div>
                        <div class="swiper-slide" style="background-image: url('../../images/slide04.jpg')"><a class="link" href=""></a></div>
                        <div class="swiper-slide" style="background-image: url('../../images/slide05.jpg')"><a class="link" href=""></a></div>
                    </div>
                    <!-- Add Pagination -->
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </main>

        <footer class="foot">
            <div class="page-tabs">
                <a class="page-tab page-home on" href="/pages/index/">
                    <i class="icon"></i>
                    <div>首页</div>
                </a>
                <a class="page-tab page-product" href="/pages/product/">
                    <i class="icon"></i>
                    <div>系列</div>
                </a>
                <a class="page-tab page-diy" href="/pages/diy/">
                    <i class="icon"></i>
                    <div>定制</div>
                </a>
                <a class="page-tab page-search" href="/pages/search/">
                    <i class="icon"></i>
                    <div>发现</div>
                </a>
                <a class="page-tab page-user" href="/pages/user/">
                    <i class="icon"></i>
                    <div>我的</div>
                </a>
            </div>
        </footer>
    </div>

        <script src="../../js/vendor/modernizr-3.5.0.min.js"></script>
        <script src="../../js/vendor/jquery-3.2.1.min.js"></script>
        <script src="../../js/vendor/ScrollFix.js"></script>
        <script src="../../js/vendor/swiper/js/swiper.min.js"></script>
        <script src="../../js/vendor/videojs/video.min.js"></script>
        <script src="../../js/main.js"></script>

        <script>

            $(function(){

                videojs("video", {
                    loop: true,
                    autoplay: false,
                    muted: true,
                    preload: "auto",
                    poster: "../../images/thumb-video.jpg",
                    fluid: true,
                    controls: true,
                    sources: [{
                        src: 'http://vjs.zencdn.net/v/oceans.mp4',
                        type: 'video/mp4'
                    }, {
                        src: 'http://vjs.zencdn.net/v/oceans.webm',
                        type: 'video/webm'
                    }],
                    controlBar: {
                        captionsButton: false,
                        chaptersButton : false,
                        liveDisplay:false,
                        playbackRateMenuButton: false,
                        subtitlesButton:false
                    }
                });

                $(".page-slide").on("touchStart", function (e) {
                    e.defaultPrevented();
                    e.stopPropagation();
                });

                var pageSwiper = new Swiper('.swiper-container', {
                    direction: 'vertical',
                    allowTouchMove: false,
                    slidesPerView: 1,
                    spaceBetween: 0,
                    pagination: {
                        el: '.swiper-pagination'
                    }
                });

                //设置为全局变量，在隐藏头部底部时更新swiper
                window.pageSwiper = pageSwiper;

                // 向下滚动到第一屏时，禁用swiper的touch事件
                pageSwiper.on("touchEnd", function(e){

                    if(pageSwiper.activeIndex <= 1 && pageSwiper.touches.diff > 0){
                        // $("#main").animate({"scrollTop": mod1Height + mod2Height - 250}, 500);
                        pageSwiper.allowTouchMove = false;
                    }

                });

                var mod1Height = $("#mod1").outerHeight(true);
                var mod2Height = $("#mod2").outerHeight(true);

                $("#main").scroll(function(){
                    var scrollTop = $("#main").scrollTop();



                    if(  Math.abs( mod1Height + mod2Height - scrollTop) < 1 ){
                        // $("#main").animate({"scrollTop": mod1Height + mod2Height}, 500);
                        pageSwiper.allowTouchMove = true;
                    }
                });

                /* 去除橡皮筋效果 */
                var scrollable = document.getElementById("main");
                new ScrollFix(scrollable);

            });

        </script>
    </body>
</html>
